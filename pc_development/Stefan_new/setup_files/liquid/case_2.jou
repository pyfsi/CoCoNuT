file set-batch-options n n n
(enable-dynamic-mesh-node-ids #t)
;file start "transcript_setup.txt"
file read-case 1D_right.msh
grid check
grid modify-zones zone-type 2 fluid

define user-defined user-defined-memory 11

define models viscous laminar y
define models solver pressure-based y
define models energy y n n n y
solve set equations flow n

define materials copy fluid air pcm
define materials change-create pcm , yes constant 870 yes constant 2500 yes constant 1.5 yes constant 0.004 no yes 8.61e-4 n

define boundary-conditions fluid , y pcm n n n n , n , n y n
define boundary-conditions wall adiabatic 0 n 0 n n n 0 y motion-bc-stationary n n ,
;heated wall 10 Â°C above solidus temp.
define boundary-conditions wall wall 0 n 0 n y temperature n 309.15 y motion-bc-stationary n n ,
define boundary-conditions wall boundary 0 n 0 n y temperature n 299.16 y motion-bc-stationary n n ,

;define operating-conditions operating-pressure 0
define operating-conditions gravity n

solve monitors residual check-convergence y
solve monitors residual convergence-criteria 1.0E-12

solve set discretization-scheme temperature 0
solve set gradient-scheme n y
;solve set under-relaxation temperature 0.3

;solve set reporting-interval 10
;solve set flow-warnings n

;Initialise liquid at liquidus temp.
solve initialize set-defaults temperature 299.16
solve initialize initialize-flow
solve iterate 40

define models unsteady-1st-order y

define dynamic-mesh dynamic-mesh y n n y n
define dynamic-mesh controls smoothing y
define dynamic-mesh controls smoothing-parameters smoothing-method spring
define dynamic-mesh controls smoothing-parameters constant-factor 1
define dynamic-mesh controls smoothing-parameters bnd-node-relaxation 1
define dynamic-mesh controls smoothing-parameters bnd-stiffness-factor 1
define dynamic-mesh controls smoothing-parameters skew-smooth-niter 10
define dynamic-mesh controls smoothing-parameters skew-smooth-cell-skew-max 0.7
define dynamic-mesh controls smoothing-parameters max-iter 20
define dynamic-mesh controls smoothing-parameters spring-on-all-elements y
define dynamic-mesh controls layering n
define dynamic-mesh controls remeshing n
define dynamic-mesh zones create adiabatic deforming faceted n y n n y n y
;define dynamic-mesh zones create 2 deforming y all n n 0.0006 0.0100 0.5

file write-case-data pc_fluid.cas.h5
exit
