
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="site_description">
      
      
      
      
      <link rel="shortcut icon" href="assets/images/favicon.ico">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-6.1.6">
    
    
      
        <title>Models - CoCoNuT</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.6910b76c.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.196e0c26.min.css">
        
          
          
          <meta name="theme-color" content="#4cae4f">
        
      
    
    
    
      
        
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="green" data-md-color-accent="green">
      
  
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#models" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

  

<header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="./index.html" title="CoCoNuT" class="md-header-nav__button md-logo" aria-label="CoCoNuT">
      
  <img src="images/logo.png" alt="logo">

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            CoCoNuT
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              Models
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header-nav__source">
        
<a href="https://github.com/pyfsi/coconut" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  

<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="./index.html" title="CoCoNuT" class="md-nav__button md-logo" aria-label="CoCoNuT">
      
  <img src="images/logo.png" alt="logo">

    </a>
    CoCoNuT
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/pyfsi/coconut" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="index.html" class="md-nav__link">
      Introduction
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" checked>
    <label class="md-nav__link" for="nav-2">
      Coupling components
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Coupling components" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        <span class="md-nav__icon md-icon"></span>
        Coupling components
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="coupling_components.html" class="md-nav__link">
      General
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="convergence_criteria.html" class="md-nav__link">
      Convergence criteria
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-3" type="checkbox" id="nav-2-3" checked>
    <label class="md-nav__link" for="nav-2-3">
      Coupled solvers
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Coupled solvers" data-md-level="2">
      <label class="md-nav__title" for="nav-2-3">
        <span class="md-nav__icon md-icon"></span>
        Coupled solvers
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="coupled_solvers.html" class="md-nav__link">
      Coupled solvers
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Models
        <span class="md-nav__icon md-icon"></span>
      </label>
    
    <a href="models.html" class="md-nav__link md-nav__link--active">
      Models
    </a>
    
      
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#common-methods" class="md-nav__link">
    Common methods
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#least-squares" class="md-nav__link">
    Least-squares
  </a>
  
    <nav class="md-nav" aria-label="Least-squares">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#settings" class="md-nav__link">
    Settings
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#multi-vector" class="md-nav__link">
    Multi-vector
  </a>
  
    <nav class="md-nav" aria-label="Multi-vector">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#settings_1" class="md-nav__link">
    Settings
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#multi-vector-matrix-free" class="md-nav__link">
    Multi-vector matrix-free
  </a>
  
    <nav class="md-nav" aria-label="Multi-vector matrix-free">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#settings_2" class="md-nav__link">
    Settings
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    References
  </a>
  
</li>
      
    </ul>
  
</nav>
    
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="mappers.html" class="md-nav__link">
      Mappers
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="predictors.html" class="md-nav__link">
      Predictors
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-6" type="checkbox" id="nav-2-6" >
    <label class="md-nav__link" for="nav-2-6">
      Solver wrappers
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Solver wrappers" data-md-level="2">
      <label class="md-nav__title" for="nav-2-6">
        <span class="md-nav__icon md-icon"></span>
        Solver wrappers
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="solver_wrappers.html" class="md-nav__link">
      General
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="abaqus.html" class="md-nav__link">
      Abaqus
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="fluent.html" class="md-nav__link">
      Fluent
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="kratos.html" class="md-nav__link">
      Kratos
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="openfoam.html" class="md-nav__link">
      OpenFOAM
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="python.html" class="md-nav__link">
      Python
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="data_structure.html" class="md-nav__link">
      Data structure
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="docs.html" class="md-nav__link">
      Documentation
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5" >
    <label class="md-nav__link" for="nav-5">
      Examples
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Examples" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        <span class="md-nav__icon md-icon"></span>
        Examples
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="examples.html" class="md-nav__link">
      General
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-5-2" type="checkbox" id="nav-5-2" >
    <label class="md-nav__link" for="nav-5-2">
      Breaking dam
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Breaking dam" data-md-level="2">
      <label class="md-nav__title" for="nav-5-2">
        <span class="md-nav__icon md-icon"></span>
        Breaking dam
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="breaking_dam_fluent2d_abaqus2d.html" class="md-nav__link">
      Fluent 2D - Abaqus 2D
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-5-3" type="checkbox" id="nav-5-3" >
    <label class="md-nav__link" for="nav-5-3">
      Tube
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Tube" data-md-level="2">
      <label class="md-nav__title" for="nav-5-3">
        <span class="md-nav__icon md-icon"></span>
        Tube
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="tube_tube_flow_tube_structure.html" class="md-nav__link">
      Python TubeFlow - Python TubeStructre
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="tube_tube_flow_tube_ringmodel.html" class="md-nav__link">
      Python TubeFlow - Python TubeRingmodel
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="tube_tube_flow_abaqus2d.html" class="md-nav__link">
      Python TubeFlow - Abaqus 2D
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="tube_fluent2d_tube_structure.html" class="md-nav__link">
      Fluent 2D - Python TubeStructure
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="tube_fluent2d_abaqus2d.html" class="md-nav__link">
      Fluent 2D - Abaqus 2D
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="tube_fluent2d_abaqus2d_steady.html" class="md-nav__link">
      Fluent 2D - Abaqus 2D - Steady
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="tube_fluent3d_abaqus2d.html" class="md-nav__link">
      Fluent 3D - Abaqus 2D
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="tube_fluent3d_abaqus3d.html" class="md-nav__link">
      Fluent 3D - Abaqus 3D
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="tube_fluent3d_kratos_structure3d.html" class="md-nav__link">
      Fluent 3D - Kratos Structure 3D
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="tube_openfoam3d_abaqus3d.html" class="md-nav__link">
      OpenFOAM 3D - Abaqus 3D
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="tube_openfoam3d_kratos_structure3d.html" class="md-nav__link">
      OpenFOAM 3D - Kratos Structure 3D
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-5-4" type="checkbox" id="nav-5-4" >
    <label class="md-nav__link" for="nav-5-4">
      Turek benchmark
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Turek benchmark" data-md-level="2">
      <label class="md-nav__title" for="nav-5-4">
        <span class="md-nav__icon md-icon"></span>
        Turek benchmark
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="turek_fluent2d_abaqus2d.html" class="md-nav__link">
      Fluent 2D - Abaqus 2D
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="turek_fluent2d_abaqus2d_steady.html" class="md-nav__link">
      Fluent 2D - Abaqus 2D - Steady
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="test_single_solver.html" class="md-nav__link">
      Test single solver
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="tests.html" class="md-nav__link">
      Tests
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#common-methods" class="md-nav__link">
    Common methods
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#least-squares" class="md-nav__link">
    Least-squares
  </a>
  
    <nav class="md-nav" aria-label="Least-squares">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#settings" class="md-nav__link">
    Settings
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#multi-vector" class="md-nav__link">
    Multi-vector
  </a>
  
    <nav class="md-nav" aria-label="Multi-vector">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#settings_1" class="md-nav__link">
    Settings
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#multi-vector-matrix-free" class="md-nav__link">
    Multi-vector matrix-free
  </a>
  
    <nav class="md-nav" aria-label="Multi-vector matrix-free">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#settings_2" class="md-nav__link">
    Settings
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    References
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="models">Models</h1>
<p>This documentation describes the different types of available models. The purpose of a model is always to approximate a (inverse) Jacobian of a system, based on secant information from input and output pairs.
In order to approximate the Jacobian <span><span class="MathJax_Preview">\mathcal{A}'</span><script type="math/tex">\mathcal{A}'</script></span> of a general function <span><span class="MathJax_Preview">a=\mathcal{A}(b)</span><script type="math/tex">a=\mathcal{A}(b)</script></span>, the model needs to be supplied with matching input and output pairs, (<span><span class="MathJax_Preview">b^i</span><script type="math/tex">b^i</script></span>, <span><span class="MathJax_Preview">a^i=\mathcal{A}(b^i)</span><script type="math/tex">a^i=\mathcal{A}(b^i)</script></span>).
Once at least two pairs have been supplied, the model is able to approximately predict the product of the Jacobian with an arbitrary vector <span><span class="MathJax_Preview">\Delta b</span><script type="math/tex">\Delta b</script></span>.
In other words, when the a vector <span><span class="MathJax_Preview">\Delta b</span><script type="math/tex">\Delta b</script></span> is given it outputs <span><span class="MathJax_Preview">\Delta a=\widehat{\mathcal{A}}'\Delta b</span><script type="math/tex">\Delta a=\widehat{\mathcal{A}}'\Delta b</script></span>, where the hat symbol is used to denote that an approximation of the Jacobain is used.</p>
<p>Which Jacobian is approximated in practice will depend on the use of the model in the coupled solver.
For example, using the coupled solver <code>CoupledSolverIQNI</code> with the model <code>ModelLS</code> corresponds to the IQN-ILS method developed by Degroote et al. [<a href="#1">1</a>]. In that case, the approximated Jacobian is <span><span class="MathJax_Preview">\mathcal{R}'^{-1}</span><script type="math/tex">\mathcal{R}'^{-1}</script></span>.
If the coupled solver <code>CoupledSolverIBQN</code> is combined with two instances the model <code>ModelLS</code>, the resulting algorithm corresponds to the IBQN-LS method developed by Vierendeels et al. [<a href="#2">2</a>]. Then, the two models each approximate one Jacobian: <span><span class="MathJax_Preview">\mathcal{F}'</span><script type="math/tex">\mathcal{F}'</script></span> and <span><span class="MathJax_Preview">\mathcal{S}'</span><script type="math/tex">\mathcal{S}'</script></span>.
Refer to the <a href="https://pyfsi.github.io/coconut/coupled_solvers">coupled solvers documentation</a> for more information on these notations.</p>
<p>In the following, the example from IQN-ILS will be used: the inverse Jacobian of <span><span class="MathJax_Preview">\mathcal{R}'</span><script type="math/tex">\mathcal{R}'</script></span> with respect to <span><span class="MathJax_Preview">\tilde{x}</span><script type="math/tex">\tilde{x}</script></span> is approximated which has an input vector <span><span class="MathJax_Preview">r</span><script type="math/tex">r</script></span> and an output vector <span><span class="MathJax_Preview">\tilde{x}</span><script type="math/tex">\tilde{x}</script></span>.
For brevity, the approximation will denoted by <span><span class="MathJax_Preview">N^k</span><script type="math/tex">N^k</script></span>, where the superscript <span><span class="MathJax_Preview">k</span><script type="math/tex">k</script></span> referes to the iteration.</p>
<h2 id="common-methods">Common methods</h2>
<p>There are three model-specific methods which are implemented by all models.</p>
<p>The first of which is the <code>predict(dr)</code> method, which returns an estimation of <span><span class="MathJax_Preview">\Delta \tilde{x}=N^k\Delta r</span><script type="math/tex">\Delta \tilde{x}=N^k\Delta r</script></span> from an input <span><span class="MathJax_Preview">\Delta r</span><script type="math/tex">\Delta r</script></span>, based on stored input and output pairs.
Second, in order to improve the estimation, input-output pairs can be added to the model using the method <code>add(r, xt)</code>.
Third, the method <code>filter_q(dr)</code> returns the part of vector <span><span class="MathJax_Preview">\Delta r</span><script type="math/tex">\Delta r</script></span> which is orthogonal to the columnspace of the matrix containing the differences between consecutively stored inputs. In other words, it returns the part of the input vector <span><span class="MathJax_Preview">\Delta r</span><script type="math/tex">\Delta r</script></span> for which the deficient approximation of the Jacobian holds no information. Note that it is equal to the part of the vector <span><span class="MathJax_Preview">\Delta r</span><script type="math/tex">\Delta r</script></span> which is inside the nullspace of the approximation of the Jacobian represented by the model.</p>
<h2 id="least-squares">Least-squares</h2>
<p>The <code>type</code> for this model is <code>coupled_solvers.models.ls</code>.
The abbreviation LS stands for <em>least-squares</em>.
From the received input vectors <span><span class="MathJax_Preview">r^i</span><script type="math/tex">r^i</script></span> and output vectors <span><span class="MathJax_Preview">\tilde{x}^i</span><script type="math/tex">\tilde{x}^i</script></span>, differences are constructed
$$
\delta r^{i-1}=r^i-r^{i-1},
\;
\delta \tilde{x}^{i-1}=\tilde{x}^i-\tilde{x}^{i-1}.
$$
These are stored as column of the matrices <span><span class="MathJax_Preview">V</span><script type="math/tex">V</script></span> and <span><span class="MathJax_Preview">W</span><script type="math/tex">W</script></span>.
This model requires the approximation of the Jacobian, denoted by <span><span class="MathJax_Preview">N^k</span><script type="math/tex">N^k</script></span>, to fulfill the secant equations:
$$
W=N^k V.
$$
In addition to this a minimal norm requirement is imposed (hence the name).</p>
<p>The differences can be limited to the current time step only. However, using the reuse parameter <code>q</code>, the differences from the <code>q</code> previous time steps are included as well.
It is important to note that differences between the input and outputs from different time steps are not considered.
Reuse may greatly improve the convergence speed and stability. The optimal value of <code>q</code> is problem dependent. Typically, however, an optimal value is around 10.</p>
<p>This model is matrix-free, due to an implementation using QR-decomposition. With matrix-free is meant that no large dense matrices are constructed, not that no matrices are used at all.
The <span><span class="MathJax_Preview">R</span><script type="math/tex">R</script></span> matrix from the QR-decomposition has to be invertible. Therefore, (almost) linearly dependent columns in the matrix containing the input information from the current and previous time steps should be removed. This is called filtering. The larger <code>q</code>, the more important filtering becomes.
If the diagonal element in <span><span class="MathJax_Preview">R</span><script type="math/tex">R</script></span> is smaller than an absolute tolerance level <code>min_significant</code>, the corresponding column is removed.
The implementation is as such that the most recent information is kept.</p>
<p>For more information refer to [<a href="#3">3</a>].</p>
<p>As mentioned before, the combination of this model wiht the coupled solver <code>CoupledSolverIQNI</code> corresponds to the IQN-ILS method developed by Degroote et al. [<a href="#1">1</a>], while using twice this model with the coupled solver <code>CoupledSolverIBQN</code> corresponds to the IBQN-LS method developed by Vierendeels et al. [<a href="#2">2</a>].</p>
<h3 id="settings">Settings</h3>
<p>The following parameters need to be included in the <code>settings</code> dictionary.
They are listed in alphabetical order.</p>
<table>
<thead>
<tr>
<th align="right">parameter</th>
<th align="center">type</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="right"><nobr><code>min_significant</code></nobr></td>
<td align="center">double</td>
<td>Absolute tolerance for filtering. To disable filtering set to <code>0</code>.</td>
</tr>
<tr>
<td align="right"><code>q</code></td>
<td align="center">int</td>
<td>Number of previous time steps that are reused. In a steady simulation there are no previous time steps, so then it should be <code>0</code>.</td>
</tr>
</tbody>
</table>
<h2 id="multi-vector">Multi-vector</h2>
<p>The <code>type</code> for this model is <code>coupled_solvers.models.mv</code>. The abbreviation MV stands for <em>multi-vector</em>.</p>
<p>In this model, differences are constructed similar to the least-squares model. However, it requires the approximation <span><span class="MathJax_Preview">N^k</span><script type="math/tex">N^k</script></span> to fulfill the secant equations of the current time step only. Moreover, it is required that the approximation is as close as possible to the previous time step. In this model large dense matrices are constructed and is hence discouraged for cases with a large number of degrees of freedom on the interface.</p>
<p>Filtering can also be applied here, then (almost) linear columns in the matrix containing the input information from the current time step are removed. However, filtering is much less critical compared to the <code>LS</code> model as it concerns only the information from the current time step. If no filtering is wanted, the tolerance level should be set to zero.</p>
<p>For more information refer to [<a href="#3">3</a>].</p>
<p>The combination of this model with the coupled solver <code>CoupledSolverIQNI</code> corresponds to the IQN-MVJ from Lindner et al. [<a href="#4">4</a>], while using twice this model with the coupled solver <code>CoupledSolverIBQN</code> corresponds to the MVQN method developed by Bogaers et al. [<a href="#5">5</a>].</p>
<h3 id="settings_1">Settings</h3>
<p>The following parameters need to be included in the <code>settings</code> dictionary.
They are listed in alphabetical order.</p>
<table>
<thead>
<tr>
<th align="right">parameter</th>
<th align="center">type</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="right"><nobr><code>min_significant</code></nobr></td>
<td align="center">double</td>
<td>(optional) Default: <code>0</code> (disabled). Absolute tolerance for filtering.</td>
</tr>
</tbody>
</table>
<h2 id="multi-vector-matrix-free">Multi-vector matrix-free</h2>
<p>The <code>type</code> for this model is <code>coupled_solvers.models.mv_mf</code>. The abbreviation MV-MF stands for <em>multi-vector matrix-free</em>.</p>
<p>By combining the QR-approach from the least-squares model with the time step wise storage of secant information, a matrix-free implementation of the multi-vector approach is obtained quite naturally. This implementation was also thought of by Spenke et al. [<a href="#6">6</a>].</p>
<p>In this approach, the contribution of each time step is grouped into a separate term, where the most recent time step has priority over the later ones. Therefore, a parameter <code>q</code> is used to denote how many time steps are reused. Setting this parameter very large, this model will act the same as <code>MV</code>, which reuses all time steps. Generally, the performance will increase when this parameter is chosen larger, but so will be the computational cost. Nonetheless, this cost is much smaller compared to the non-matrix-free multi-vector approach.</p>
<p>Filtering can be applied similar to the above described models, but this is typically not necessary.</p>
<h3 id="settings_2">Settings</h3>
<p>The following parameters need to be included in the <code>settings</code> dictionary.
They are listed in alphabetical order.</p>
<table>
<thead>
<tr>
<th align="right">parameter</th>
<th align="center">type</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="right"><nobr><code>min_significant</code></nobr></td>
<td align="center">double</td>
<td>(optional) Default: <code>0</code> (disabled). Absolute tolerance for filtering.</td>
</tr>
<tr>
<td align="right"><code>q</code></td>
<td align="center">int</td>
<td>Number of previous time steps that are reused. In a steady simulation there are no previous time steps, so then it should be 0.</td>
</tr>
</tbody>
</table>
<h2 id="references">References</h2>
<p><a id="1">[1]</a> 
<a href="http://hdl.handle.net/1854/LU-533365">Degroote J., Bathe K.-J., Vierendeels J., "Performance of a new partitioned procedure versus a monolithic procedure in fluid-structure interaction", Computers &amp; Structures, vol. 87, no. 11–12, pp. 793-801, 2009.</a></p>
<p><a id="2">[2]</a> 
<a href="http://hdl.handle.net/1854/LU-409369">Vierendeels J., Lanoye L., Degroote J., Verdonck P., "Implicit coupling of partitioned fluid-structure interaction problems with reduced order models", Computers &amp; Structures, vol. 85, no. 11–14, pp. 970–976, 2007.</a></p>
<p><a id="3">[3]</a> 
<a href="http://hdl.handle.net/1854/LU-8685199">Delaissé N., Demeester T., Fauconnier D. and Degroote J., "Comparison of different quasi-Newton techniques for coupling of black box solvers", in ECCOMAS 2020, Proceedings, Paris, France, 2021.</a></p>
<p><a id="4">[4]</a> 
<a href="https://www.researchgate.net/publication/277077208_A_Comparison_of_various_Quasi-Newton_Schemes_for_Partitioned_Fluid-Structure_Interaction">Lindner F., Mehl M., Scheufele K., Uekermann B., "A comparison of various quasi-Newton schemes for partitioned fluid-structure interaction", in: B. Schrefler, E. Oñate, M. Papadrakakis (Eds.), 6th International Conference on Computational 975 Methods for Coupled Problems in Science and Engineering, pp. 477–488, 2015.</a></p>
<p><a id="5">[5]</a> 
<a href="https://doi.org/10.1016/j.cma.2014.06.033">Bogaers A., Kok S., Reddy B., Franz T., "Quasi-Newton methods for implicit black-box FSI coupling", ComputerMethods in AppliedMechanics and Engineering, vol. 279, pp. 113–132, 2014.</a></p>
<p><a id="6">[6]</a> 
<a href="https://doi.org/10.1016/j.cma.2019.112810">Spenke T., Hosters N., Behr M., "A multi-vector interface quasi-newton method with linear complexity for partitioned fluid–structure interaction", Computer Methods in Applied Mechanics and Engineering, vol. 361, pp. 112810, 2020.</a></p>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="coupled_solvers.html" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Coupled solvers
              </div>
            </div>
          </a>
        
        
          <a href="mappers.html" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Mappers
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="assets/javascripts/vendor.fd16492e.min.js"></script>
      <script src="assets/javascripts/bundle.7836ba4d.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}</script>
      
      <script>
        app = initialize({
          base: ".",
          features: [],
          search: Object.assign({
            worker: "assets/javascripts/worker/search.4ac00218.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script>
      
    
  </body>
</html>